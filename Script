local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "Jarad'sLibrary"
ScreenGui.Parent = game:GetService("CoreGui")

local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(45, 10, 80)
MainFrame.BackgroundTransparency = 0.1
MainFrame.Position = UDim2.new(0.35, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 260, 0, 340)  -- Height for TikTok label
MainFrame.Active = true
MainFrame.Draggable = false -- disable built-in draggable, use custom dragging below
MainFrame.ZIndex = 1

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0, 12)

local UIStroke = Instance.new("UIStroke", MainFrame)
UIStroke.Color = Color3.fromRGB(180, 100, 255)
UIStroke.Thickness = 2

local Gradient = Instance.new("UIGradient", MainFrame)
Gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(60, 0, 100)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 0, 60))
}
Gradient.Rotation = 45

local Title = Instance.new("TextLabel", MainFrame)
Title.BackgroundTransparency = 1
Title.Size = UDim2.new(1, 0, 0, 35)
Title.Font = Enum.Font.GothamBold
Title.Text = "ðŸ“š Jarad's Library"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 18
Title.TextStrokeTransparency = 0.7
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Position = UDim2.new(0, 10, 0, 5)

local LastUsedLabel = Instance.new("TextLabel", MainFrame)
LastUsedLabel.BackgroundTransparency = 1
LastUsedLabel.Position = UDim2.new(0, 10, 0, 32)
LastUsedLabel.Size = UDim2.new(1, -20, 0, 20)
LastUsedLabel.Font = Enum.Font.GothamBold
LastUsedLabel.Text = "Last Used: None"
LastUsedLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
LastUsedLabel.TextSize = 13
LastUsedLabel.TextTransparency = 0.1
LastUsedLabel.TextXAlignment = Enum.TextXAlignment.Left

local SearchBar = Instance.new("TextBox", MainFrame)
SearchBar.PlaceholderText = "Search scripts..."
SearchBar.Text = ""
SearchBar.Size = UDim2.new(0, 230, 0, 30)
SearchBar.Position = UDim2.new(0.5, -115, 0, 55)
SearchBar.BackgroundColor3 = Color3.fromRGB(60, 20, 100)
SearchBar.TextColor3 = Color3.fromRGB(255, 255, 255)
SearchBar.PlaceholderColor3 = Color3.fromRGB(180, 180, 180)
SearchBar.Font = Enum.Font.GothamBold
SearchBar.TextSize = 14
SearchBar.ClearTextOnFocus = false

local SearchCorner = Instance.new("UICorner", SearchBar)
SearchCorner.CornerRadius = UDim.new(0, 6)

local SearchPadding = Instance.new("UIPadding", SearchBar)
SearchPadding.PaddingLeft = UDim.new(0, 10)
SearchPadding.PaddingRight = UDim.new(0, 25) -- space for clear button

local ClearSearchBtn = Instance.new("TextButton")
ClearSearchBtn.Name = "ClearSearchBtn"
ClearSearchBtn.Parent = SearchBar
ClearSearchBtn.Size = UDim2.new(0, 20, 0, 20)
ClearSearchBtn.Position = UDim2.new(1, -22, 0, 5)
ClearSearchBtn.BackgroundColor3 = Color3.fromRGB(180, 60, 100)
ClearSearchBtn.Text = "X"
ClearSearchBtn.Font = Enum.Font.GothamBold
ClearSearchBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ClearSearchBtn.TextSize = 12
ClearSearchBtn.Visible = false

local ClearCorner = Instance.new("UICorner", ClearSearchBtn)
ClearCorner.CornerRadius = UDim.new(1, 0)

local CloseBtn = Instance.new("TextButton", MainFrame)
CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 60, 60)
CloseBtn.Position = UDim2.new(1, -30, 0, 5)
CloseBtn.Size = UDim2.new(0, 20, 0, 20)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 12

local CloseCorner = Instance.new("UICorner", CloseBtn)
CloseCorner.CornerRadius = UDim.new(1, 0)

CloseBtn.MouseButton1Click:Connect(function()
	ScreenGui:Destroy()
end)

local MinimizeBtn = Instance.new("TextButton", MainFrame)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(120, 80, 255)
MinimizeBtn.Position = UDim2.new(1, -55, 0, 5)
MinimizeBtn.Size = UDim2.new(0, 20, 0, 20)
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.Text = "-"
MinimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeBtn.TextSize = 12

local MinimizeCorner = Instance.new("UICorner", MinimizeBtn)
MinimizeCorner.CornerRadius = UDim.new(1, 0)

local ScrollingFrame = Instance.new("ScrollingFrame", MainFrame)
ScrollingFrame.BackgroundTransparency = 1
ScrollingFrame.Position = UDim2.new(0, 0, 0, 90)
ScrollingFrame.Size = UDim2.new(1, 0, 1, -130)
ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
ScrollingFrame.ScrollBarThickness = 6
ScrollingFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y

local UIListLayout = Instance.new("UIListLayout", ScrollingFrame)
UIListLayout.SortOrder = Enum.SortOrder.LayoutOrder
UIListLayout.Padding = UDim.new(0, 8)

local UIPadding = Instance.new("UIPadding", ScrollingFrame)
UIPadding.PaddingTop = UDim.new(0, 10)
UIPadding.PaddingLeft = UDim.new(0, 10)
UIPadding.PaddingRight = UDim.new(0, 10)

local CreditLabel = Instance.new("TextLabel", MainFrame)
CreditLabel.BackgroundTransparency = 1
CreditLabel.Position = UDim2.new(0, 0, 1, -25)
CreditLabel.Size = UDim2.new(1, 0, 0, 20)
CreditLabel.Font = Enum.Font.GothamBold
CreditLabel.Text = "TikTok : @Whosjaradd"
CreditLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
CreditLabel.TextSize = 14
CreditLabel.TextTransparency = 0
CreditLabel.TextXAlignment = Enum.TextXAlignment.Center

local buttonData = {
	["DarkScript Spawner"] = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/veryimportantrr/x/refs/heads/main/gag_visual.lua"))()',
	["Ronix Hub"] = 'loadstring(game:HttpGet("https://api.luarmor.net/files/v3/loaders/b44706178039e9b88c4d768d4d8b012f.lua"))()',
	["Thunder Z Hub"] = "loadstring(game:HttpGet('https://raw.githubusercontent.com/ThundarZ/Welcome/refs/heads/main/Main/GaG/Main.lua'))()",
	["Limit Hub"] = "loadstring(game:HttpGet(('https://raw.githubusercontent.com/FakeModz/LimitHub/refs/heads/main/LimitHub_Luarmor_E.lua')))()",
	["Speed Hub"] = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/AhmadV99/Speed-Hub-X/main/Speed%20Hub%20X.lua", true))()',
	["Quantum Hub (Keyless)"] = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/flazhy/QuantumOnyx/refs/heads/main/QuantumOnyx.lua"))()',
    ["All-in-one Script"] = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/jazzedd/Jaradscript/refs/heads/main/jarapd%20script"))()',
    ["ZysumeHub"] = 'loadstring(game:HttpGet("https://raw.githubusercontent.com/ZusumeHub/ZusumeHub/refs/heads/main/UpdateZysume"))()'
}

local AllButtons = {}

for name, scriptStr in pairs(buttonData) do
	local btn = Instance.new("TextButton")
	btn.Name = name:gsub("%W+", "").."Btn"
	btn.Parent = ScrollingFrame
	btn.Size = UDim2.new(1, 0, 0, 30)
	btn.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
	btn.TextColor3 = Color3.fromRGB(255, 255, 255)
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 14
	btn.Text = name
	btn.AutoButtonColor = false

	local btnCorner = Instance.new("UICorner", btn)
	btnCorner.CornerRadius = UDim.new(0, 6)

	-- Hover effect
	btn.MouseEnter:Connect(function()
		TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(160, 100, 255)}):Play()
	end)
	btn.MouseLeave:Connect(function()
		TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(120, 60, 200)}):Play()
	end)

	btn.MouseButton1Click:Connect(function()
		pcall(function()
			loadstring(scriptStr)()
		end)
	end)

	AllButtons[name:lower()] = btn
end

-- Update canvas size when buttons change
local function updateCanvas()
	ScrollingFrame.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 20)
end
UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateCanvas)
updateCanvas()

-- Search bar logic to filter buttons visually:
SearchBar:GetPropertyChangedSignal("Text"):Connect(function()
	local query = SearchBar.Text:lower()
	ClearSearchBtn.Visible = (#query > 0)
	for name, button in pairs(AllButtons) do
		button.Visible = string.find(name, query) ~= nil
	end
	updateCanvas()
end)

ClearSearchBtn.MouseButton1Click:Connect(function()
	SearchBar.Text = ""
	ClearSearchBtn.Visible = false
	for _, button in pairs(AllButtons) do
		button.Visible = true
	end
	updateCanvas()
end)

-- Minimize button logic to toggle UI:
local minimized = false
local fullSize = UDim2.new(0, 260, 0, 340)
local miniSize = UDim2.new(0, 260, 0, 90)

MinimizeBtn.MouseButton1Click:Connect(function()
	minimized = not minimized
	if minimized then
		TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = miniSize}):Play()
		TweenService:Create(SearchBar, TweenInfo.new(0.2), {TextTransparency = 1, BackgroundTransparency = 1}):Play()
		TweenService:Create(ClearSearchBtn, TweenInfo.new(0.2), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
		for _, button in pairs(AllButtons) do
			TweenService:Create(button, TweenInfo.new(0.2), {BackgroundTransparency = 1, TextTransparency = 1}):Play()
		end
		TweenService:Create(ScrollingFrame, TweenInfo.new(0.3), {ScrollBarImageTransparency = 1}):Play()
	else
		TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Size = fullSize}):Play()
		TweenService:Create(SearchBar, TweenInfo.new(0.2), {TextTransparency = 0, BackgroundTransparency = 0}):Play()
		TweenService:Create(ClearSearchBtn, TweenInfo.new(0.2), {BackgroundTransparency = 0, TextTransparency = 0}):Play()
		for _, button in pairs(AllButtons) do
			TweenService:Create(button, TweenInfo.new(0.2), {BackgroundTransparency = 0, TextTransparency = 0}):Play()
		end
		TweenService:Create(ScrollingFrame, TweenInfo.new(0.3), {ScrollBarImageTransparency = 0}):Play()
	end
end)

-- === Universal Dragging (Mouse + Touch) ===
local dragging
local dragInput
local dragStart
local startPos

local function update(input)
	local delta = input.Position - dragStart
	MainFrame.Position = UDim2.new(
		startPos.X.Scale, startPos.X.Offset + delta.X,
		startPos.Y.Scale, startPos.Y.Offset + delta.Y
	)
end

MainFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = MainFrame.Position

		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
			end
		end)
	end
end)

MainFrame.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)

UserInputService.InputChanged:Connect(function(input)
	if input == dragInput and dragging then
		update(input)
	end
end)
